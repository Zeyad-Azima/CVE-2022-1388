//Author: Zeyad Azima
//Linkedin: https://www.linkedin.com/in/zer0verflow/
//Github: https://github.com/Zeyad-Azima
package cve_2022_1388;

import java.io.*;
import java.net.*;

public class testConnection {

    private String targetHost;
    private static final String userAgent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.246";
    private static final String endPoint = "mgmt/tm/util/bash";
    public testConnection(String targetHost){

        this.targetHost = targetHost;
    }


    public void requestHost() throws IOException{
        if (!this.targetHost.endsWith("/")){
            this.targetHost = this.targetHost+"/"+endPoint;
        } else if (this.targetHost.endsWith("/")){
            this.targetHost = this.targetHost+endPoint;
        }

        URL obj = new URL(this.targetHost);
        System.out.println("[+] Testing connection for " + this.targetHost);
        try{
            HttpURLConnection con = (HttpURLConnection) obj.openConnection();
            con.setRequestMethod("GET");
            con.setRequestProperty("User-Agent", userAgent);
            int responseCode = con.getResponseCode();
            System.out.println("[+] Target Response: " + responseCode);

        }catch(Exception error){
            System.out.println("[!] There is a problem");
            System.out.println("Error: " + error);

        }


    }

}
